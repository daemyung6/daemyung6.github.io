<!DOCTYPE html>
<html>
  <head>
    <title>Google Sheets API Quickstart</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <div id="list"></div>

    <pre id="content" style="white-space: pre-wrap;"></pre>

    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
    <script type="text/javascript">
    var list = document.getElementById("list");
        
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '988055380111-davuia92msoc73t8pc8n90ofd5a6mtjc.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyAtBo4MzNab3FYOI3E7VHdjw6m6fjrsK5s';

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
        
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1saokZfjSPDdHTHS5z9f84m0ehMSmJGewAKWZkHPlcLg',
                range: 'tranks',
            }).then(function(response) {
                    console.log(response)
                    let values = response.result.values;
                    let table = document.createElement("table");
                    for (let i = 0; i < values.length; i++) {
                        let tr = document.createElement("tr");
                        
                        for (let j = 0; j < values[i].length; j++) {
                            let th = document.createElement("th");
                            th.style.cssText = `
                                border : 1px solid black;
                            `
                            th.innerText = values[i][j];
                            tr.appendChild(th);
                        }
                        table.appendChild(tr);
                    }
                    document.body.appendChild(table)
                })
        }, function(error) {
          appendPre(JSON.stringify(error, null, 2));
        });
      }

    </script>

    
  </body>
</html>